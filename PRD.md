# PRD: Bithumb Auto Trading Bot

## 1. 프로젝트 개요

### 1.1 목적
실시간 시장 데이터 분석을 통해 급상승 코인을 자동으로 선정하고 매매하는 빗썸 기반 자동 투자 시스템

### 1.2 핵심 가치
- **객관적 의사결정**: 다중 기술 지표 기반 점수화 시스템으로 감정 배제
- **실시간 대응**: WebSocket 데이터 처리로 빠른 시장 대응
- **전략 검증**: 백테스팅을 통한 전략 사전 검증
- **안전한 테스트**: 실전/시뮬레이션 모드로 리스크 없는 테스트

## 2. 핵심 기능

### 2.1 자동 매매 시스템

#### 2.1.1 코인 선정 조건
- **거래대금 필터**: 30억 원 이상만 대상 (유동성 확보)
- **지표 점수**: 다중 지표 종합 점수가 임계값(70점) 이상
- **단일 포지션**: 한 번에 한 개 코인만 투자 (집중 투자)
- **시간대 고려**: 업비트 9시, 빗썸 0시 개장 시간 우선 모니터링

#### 2.1.2 매매 전략
- **익절 목표**: 8% 수익 달성 시 자동 매도
- **손절 전략**: 지표 점수 기반 홀딩 판단 (최소화 원칙)
  - 종합 점수 30점 이하일 때만 손절 고려
  - 급격한 하락 + 거래량 감소 시 강제 손절
- **투자금 관리**: 현금잔고의 설정된 퍼센트 (기본 80%)
- **수수료 반영**: 0.04% 거래 수수료 자동 계산
- **시장 국면별 전환**: 추세 강도·변동성·감성 지표를 결합해 추세 구간에서는 돌파형(모멘텀) 전략, 횡보 구간에서는 그리드+DCA 혼합 전략으로 자동 전환
- **데이터 신뢰도 기반 실행**: 감성·뉴스 신호 신뢰도가 임계치 미만이면 포지션 신규 진입을 보류하고, 기술 지표와 외부 신호가 정렬될 때만 진입 강도를 상향

#### 2.1.3 리밸런싱
- 익절 후 즉시 다음 코인 탐색
- 하락 코인도 지표 점수 높으면 매수 가능
- 포지션 없을 때만 신규 매수

#### 2.1.4 전략 파이프라인
- **4계층 점수화**
  - 1단계: 기본 기술 지표 점수 (RSI, MACD, Bollinger, 이동평균)
  - 2단계: 변동성 지표 (ATR, 24h 고/저폭, 거래량 변동률)
  - 3단계: 감성 지표 (국내 뉴스·커뮤니티·소셜 미디어 NLP 분석)
  - 4단계: 이벤트 캘린더 (거시 지표 발표, 거래소 공지, 규제 소식)
- **신호 융합 규칙**: 각 계층 점수를 가중 평균하고, 계층 간 상충 시 보수적 의견을 채택
- **위험 회피 모드**: 이벤트 계층에서 위험 이벤트가 감지되면 포지션 축소·거래 중단 조건을 자동 적용

#### 2.1.5 전략 포트폴리오
- **복수 봇 슬롯**: 계정 당 최소 3개 전략 슬롯(추세 추종, 그리드, 감성 모멘텀)을 운영하고, 자본 배분 비율을 동적으로 조정
- **AI 추천 믹스**: 사용자 성향·성과 데이터를 기반으로 전략 조합을 추천
- **전략 교대**: 월간 성과나 실시간 신뢰도 하락 시 자동으로 대체 전략을 승격

#### 2.1.6 AI 전략 비서
- **LLM 시나리오 생성**: 사용자 입력(목표 수익률, 리스크 허용치) 기반으로 전략 파라미터 제안
- **가드레일**: 미검증 지표·과도한 레버리지·과최적화 패턴을 자동 차단
- **자동 문서화**: 추천 전략을 자연어와 코드 스니펫으로 동시에 제공해 학습 곡선을 낮춤

### 2.2 기술 지표 시스템

#### 2.2.1 가격 지표
- **RSI (Relative Strength Index)**
  - 기간: 14
  - 과매도(30 이하): 매수 시그널
  - 과매수(70 이상): 매도 시그널

- **MACD (Moving Average Convergence Divergence)**
  - 단기 EMA: 12
  - 장기 EMA: 26
  - 시그널: 9
  - 골든크로스: 매수, 데드크로스: 매도

- **Bollinger Bands**
  - 기간: 20
  - 표준편차: 2
  - 하단 밴드 근접: 매수
  - 상단 밴드 근접: 매도

- **이동평균선 (Moving Average)**
  - 단기: 5일, 20일
  - 중기: 60일
  - 장기: 120일
  - 정배열: 상승 추세, 역배열: 하락 추세

#### 2.2.2 거래량 지표
- **거래량 급증 감지**
  - 평균 대비 1.5배 이상: 관심
  - 평균 대비 2배 이상: 강한 매수 시그널

- **거래대금 필터링**
  - 30억 원 미만: 제외
  - 50억 원 이상: 가산점

#### 2.2.3 점수화 시스템
- **개별 지표 점수**: 0-100점
  - RSI: 과매도/과매수 구간 기반
  - MACD: 히스토그램 및 크로스 기반
  - Bollinger: 밴드 내 위치 기반
  - 거래량: 평균 대비 비율 기반

- **가중치 적용 (Layer 1)**
  - RSI: 20%
  - MACD: 20%
  - Bollinger Bands: 15%
  - 거래량: 15%
  - (사용자 커스터마이징 가능)

- **종합 점수 계산**
  - 가중 평균으로 0-100점 산출
  - 70점 이상: 강한 매수 시그널
  - 30-70점: 보유 (중립)
  - 30점 이하: 매도 시그널

#### 2.2.4 변동성·감성 확장 지표
- **변동성**: ATR, 파생 VIX, 24시간 고저폭, 슬리피지 추정치를 사용해 포지션 사이즈·그리드 폭을 자동 보정
- **감성 분석**: 한국어 뉴스·커뮤니티·SNS 데이터를 NLP로 분류(긍정/중립/부정), 스팸·중복 필터링 후 확신도 점수 산출
- **이벤트 캘린더**: FOMC, 금통위, 빗썸 공지, 상장/상폐 일정 등 이벤트를 사전에 등록 후 실시간 트리거에 반영
- **확신도 관리**: 변동성·감성 계층 확신도가 낮을 경우 진입 강도 감소, 일정 이하이면 시그널 무시
- **가중치 적용 (Layer 2-4)**: 변동성 10%, 감성 10%, 이벤트 10%를 기본값으로 적용하고 사용자 커스터마이징 허용

#### 2.2.5 데이터 품질 및 교차 검증
- **다중 소스 비교**: 외부 데이터와 빗썸 데이터가 괴리될 경우 시그널 보류
- **가짜 뉴스 필터**: 신뢰도 높은 출처 우선 순위 및 키워드 신뢰도 점수로 가중
- **백테스트-실전 재현성**: 동일 데이터 파이프라인을 백테스트/시뮬레이션/실전에 공유해 데이터 드리프트를 최소화

### 2.3 백테스팅

#### 2.3.1 기능
- **과거 데이터 기반 검증**
  - 최소 3개월 이상 데이터
  - 1분/5분/1시간 캔들 지원

- **동일 로직 적용**
  - 실전과 동일한 지표 계산
  - 동일한 매매 전략
  - 수수료/슬리피지 반영

- **성과 분석**
  - 총 수익률
  - MDD (Maximum Drawdown)
  - 승률 / 손익비
  - 평균 보유 기간
  - 거래 횟수

#### 2.3.2 시나리오 테스트
- 다양한 시장 상황 (상승/하락/횡보)
- 지표 가중치 조합 최적화
- 익절/손절 비율 테스트

#### 2.3.3 전략별 성과 기준
- **핵심 지표**: 월간 손익률, MDD, 샤프 지수, 칼마 지수, 승률, 평균 손익비, 평균 보유 기간, 거래 빈도
- **자동 재튜닝 조건**: 전략 성과가 기준 대비 20% 이상 하락하거나 MDD 임계값을 초과하면 파라미터 재학습 실행
- **교차 검증**: 워크포워드·k-폴드 백테스트 결과가 일정 범위 안에 수렴해야 실전 승격
- **실전 검증**: 시뮬레이션 30일 → 소액 실전 14일 → 전체 자본 단계로 점진 확대

### 2.4 실시간 대시보드

#### 2.4.1 차트 분석 탭
- **캔들스틱 차트**
  - TradingView 스타일
  - 1분/5분/15분/1시간/일봉 전환
  - 실시간 업데이트 (WebSocket)

- **기술 지표 오버레이**
  - RSI 차트 (서브창)
  - MACD 히스토그램 (서브창)
  - Bollinger Bands (메인 차트)
  - 이동평균선 (메인 차트)

- **거래량 차트**
  - 막대 그래프
  - 평균 거래량 라인

- **시그널 마커**
  - 매수 시그널: 초록색 화살표
  - 매도 시그널: 빨간색 화살표
  - 점수 표시: 숫자 라벨

#### 2.4.2 포트폴리오 탭
- **현재 포지션**
  - 보유 코인 / 수량
  - 매수 평균가
  - 현재가 / 수익률
  - 평가 손익 (원화)

- **현금 잔고**
  - 가용 현금
  - 투자 중 금액
  - 총 자산

- **투자 내역**
  - 최근 거래 로그
  - 체결 가격 / 수량
  - 수수료

#### 2.4.3 시장 모니터링 탭
- **Top 30 코인 (거래대금 기준)**
  - 실시간 가격
  - 24시간 변동률
  - 거래대금
  - 종합 지표 점수

- **시그널 알림**
  - 매수 시그널 발생 코인
  - 점수 순위
  - 알림 히스토리
- **감성/이벤트 피드**
  - 뉴스·커뮤니티 감성 점수 타임라인
  - 거시/정책 이벤트 일정 및 경보
  - 감성·이벤트 확신도 지표

#### 2.4.4 백테스팅 탭
- **설정 패널**
  - 기간 선택
  - 초기 자금
  - 전략 파라미터

- **결과 차트**
  - 자산 곡선
  - 드로다운 차트
  - 거래 마커

- **통계 요약**
  - 주요 지표 테이블
  - 거래 상세 내역

### 2.5 모드 전환

#### 2.5.1 실전 모드
- 실제 빗썸 API 연동
- 실제 잔고 사용
- 실제 주문 체결
- 법적 책임 경고 표시

#### 2.5.2 시뮬레이션 모드
- 가상 잔고 (기본 1,000만 원)
- 실시간 시세는 동일
- 모의 주문 실행
- 실전 전환 시 초기화 안내

## 3. 사용자 스토리

### 3.1 자동 투자자
> "매일 출근하는 직장인인데, 코인 시장을 24시간 모니터링할 수 없어요. 시스템이 알아서 유망 코인을 찾아 투자하고, 8%만 벌면 자동으로 익절해줬으면 좋겠어요."

**해결 방안**:
- 24/7 자동 모니터링
- 지표 기반 객관적 매매
- 익절 목표 자동 달성
- 알림으로 결과 통보

### 3.2 감정 통제 실패자
> "항상 욕심 때문에 익절을 못하고, 손실이 나면 물타기를 해서 더 큰 손실을 봐요. 감정을 배제한 매매를 하고 싶어요."

**해결 방안**:
- 8% 도달 시 무조건 익절
- 손절도 지표 점수 기반 자동 결정
- 감정 개입 여지 없음
- 백테스팅으로 전략 검증

### 3.3 전략 개발자
> "다양한 지표 조합을 테스트해보고 싶은데, 일일이 수동으로 백테스팅하기 힘들어요. 쉽게 전략을 테스트하고 최적화하고 싶어요."

**해결 방안**:
- 지표 가중치 UI로 조정
- 백테스팅 원클릭 실행
- 성과 자동 분석
- 최적 파라미터 찾기

### 3.4 초보 투자자
> "기술적 분석을 잘 모르는데, 전문가처럼 투자하고 싶어요. 어떤 코인을 사야 할지, 언제 팔아야 할지 알려주는 시스템이 필요해요."

**해결 방안**:
- 복잡한 지표를 점수로 단순화
- 자동 매매로 진입장벽 제거
- 시뮬레이션 모드로 학습
- 차트에 시그널 명확히 표시

## 4. 기능 범위

### 4.1 Phase 1 포함 (MVP)
✅ 빗썸 API 연동 (Public + Private + WebSocket)
✅ 4가지 기술 지표 (RSI, MACD, Bollinger, 거래량)
✅ 점수화 및 자동 매매 시스템
✅ 실시간 차트 대시보드
✅ 실전/시뮬레이션 모드
✅ 기본 백테스팅
✅ 포트폴리오 관리
✅ 멀티레이어 전략 파이프라인(기술 지표 + 변동성 + 감성 + 이벤트)

### 4.2 향후 확장 고려 (Phase 2+)
🔮 다중 코인 동시 투자
🔮 추가 지표 (Stochastic, Ichimoku 등)
🔮 AI 기반 패턴 인식
🔮 소셜 시그널·뉴스 감성 고도화
🔮 AI 전략 비서 고급화 (LLM 파라미터 튜닝 자동화)
🔮 텔레그램 봇 알림
🔮 모바일 앱
🔮 타 거래소 지원 (업비트, 바이낸스)

### 4.3 명시적 제외 (Out of Scope)
❌ 레버리지 거래
❌ 선물/옵션
❌ 자동 출금
❌ 타인 자금 운용
❌ 투자 조언 서비스

## 5. 제약사항 및 고려사항

### 5.1 기술적 제약
- **API Rate Limit**: 빗썸 API 호출 제한 준수
  - Public API: 초당 10회
  - Private API: 초당 8회
  - 초과 시 자동 대기 (Queue 방식)

- **WebSocket 안정성**
  - 연결 끊김 시 자동 재연결
  - Heartbeat로 연결 상태 체크
  - 데이터 유실 시 REST API로 보정

- **네트워크 지연**
  - 주문 슬리피지 최대 0.5% 가정
  - 긴급 상황 대비 Circuit Breaker

### 5.2 트레이딩 제약
- **거래 수수료**: 0.04% (빗썸 기본)
  - 매수/매도 각각 부과
  - 총 0.08% 고려 시 실질 익절 7.92%

- **최소 주문 금액**: 500원 (빗썸 정책)

- **주문 단위**: 코인별 상이
  - BTC: 0.0001 단위
  - ETH: 0.001 단위
  - 기타: API 스펙 확인

### 5.3 리스크 관리
- **일일 최대 손실**: 초기 자금의 5%
  - 초과 시 자동 매매 중지
  - 수동 재개 필요

- **긴급 정지 버튼**
  - 모든 포지션 즉시 정리
  - 시장가 매도

- **포지션 크기 제한**
  - 단일 코인 최대 80% (설정 가능)
  - 최소 20%는 현금 보유

### 5.4 법적/윤리적 고려
- **투자 책임**: 사용자 본인
  - 시스템은 보조 도구일 뿐
  - 손실 발생 시 개발자 무관

- **시세 조종 금지**
  - 대량 주문 분할 처리
  - 시장 교란 방지

- **개인정보 보호**
  - API 키 암호화 저장
  - 로컬 스토리지 사용 금지
  - Supabase Vault 활용

## 6. 성공 지표 (KPI)

### 6.1 시스템 성능
- **정확도**: 지표 계산 오차 < 0.1%
- **지연시간**: 시그널 생성 < 1초
- **가동률**: 99% 이상 (다운타임 최소화)

### 6.2 트레이딩 성과
- **전략별 월간 손익률**: 핵심 전략(추세/그리드/감성) 각각 월 8~12% 목표
- **MDD**: 전략별 15% 이하, 전체 포트폴리오 12% 이하 유지
- **승률 & 손익비**: 승률 60% 이상, 손익비 1.8:1 이상
- **샤프/칼마 지수**: 샤프 1.5 이상, 칼마 1.0 이상 유지
- **재튜닝 지표**: 성과가 기준 대비 20% 하락하거나 MDD 임계치 초과 시 자동 재튜닝 실행률 100%

### 6.3 사용자 경험
- **차트 로딩**: 3초 이내
- **주문 체결**: 5초 이내
- **페이지 응답**: 1초 이내

### 6.4 전략 안전성
- **데이터 확신도**: 감성/이벤트 계층 확신도 0.7 미만 시 자동 거래 중단 비율 100%
- **데이터 교차 검증**: 주요 외부 데이터와 빗썸 데이터 괴리율 0.5% 이내 유지
- **위험 회피 모드 반응 시간**: 위험 이벤트 감지 시 2초 이내 포지션 축소 트리거 발동

## 7. 릴리스 기준

### 7.1 MVP 출시 조건
✅ 모든 지표 정확히 계산
✅ 시뮬레이션 모드 정상 작동
✅ 백테스팅 결과 신뢰 가능
✅ 차트 실시간 업데이트
✅ 긴급 정지 버튼 작동
✅ 멀티레이어 전략 파이프라인 각 계층 신호 검증 완료
✅ AI 전략 비서가 제안한 전략이 백테스트 기준 충족

### 7.2 실전 모드 출시 조건
✅ 3개월 이상 백테스팅 검증
✅ 시뮬레이션 1개월 무사고 운영
✅ 보안 감사 통과
✅ 모든 엣지 케이스 처리
✅ 사용자 동의서 확보
✅ 전략 포트폴리오 자동 전환·재튜닝 로직 실거래 검증

## 8. 우선순위

### P0 (Must Have - MVP)
- 빗썸 API 연동
- 4가지 기술 지표
- 자동 매매 (익절 8%)
- 실시간 차트
- 시뮬레이션 모드

### P1 (Should Have - Phase 1)
- 백테스팅
- 포트폴리오 대시보드
- 손절 로직
- 알림 시스템

### P2 (Nice to Have - Phase 2)
- 지표 추가
- 모바일 최적화
- 전략 A/B 테스트
- 텔레그램 연동

### P3 (Future)
- AI 패턴 인식
- 다중 코인
- 타 거래소 지원
